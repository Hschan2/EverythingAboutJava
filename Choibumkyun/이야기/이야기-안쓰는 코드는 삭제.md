# 잠시 쉬어가는 최범균 스토리: 미삭제 코드로 바보될 뻔한 이야기

## 첫 번째 문제 파악
내역 테이블 파티션 구조 변경을 위한 점검을 진행하였다. 향후 성능 문제가 발생할 가능성이 있어서 파티션 구조의 변경을 진행하였다. 데이터 이관과 코드 수정 등 모든 준비를 마친 상태였다.   

수정한 버전을 배포하였지만 서버 구동을 실패하였다. 원인을 분석하니 구동 과정에서 오류가 발생하였고 Redis 서버에 연결이 되지 않아서 구동이 실패한 것이었다. 그리고 해당 Redis 서버도 점검의 대상이었다. 하지만 캐시를 사용하지 않는 서비스였다.   

코드를 확인하여 파악하니 사용하지 않는 의존(dependency 등)과 설정(주석 처리 등)이 발견되었다.   

이 과정에서 문제 유발 코드를 찾는 시간과 코드를 수정하고 검증하는 시간 그리고 실제 운영하고 배포하고 정상적으로 동작하는지 확인하는 시간까지 오래 걸리게 되었다.   

## 두 번째 문제 파악
기능 변경이 필요하여 코드를 분석하는 과정에서 문제가 발생하였다.

```
if (조건A && !조건B) {
    // 긴 코드
} else if (조건A && 조건B) {
    // 위와 비슷한 내용의 아주 긴 코드
} else {
    // 조금 긴 코드
}
```
첫 번째 조건문은 더 이상 실행이 되지 않는 코드였다. 기존 코드에서 조건을 추가하면서 발생한 문제였다. 시간이 흐르면서 첫 번째 조건이 필요가 없는 코드가 되었다. 즉, 요구가 바뀌게 되면서 사용하지 않게 되었다.   

코드를 분석하는 시간과 문제를 파악하고 깨닫는 시간까지 많은 시간이 소요되었다.   

## 정리
죽지 않는 미사용 코드는 빠르게 정리하는 것이 좋다. 이는 시간 낭비로 연결이 되고 대형 장애로도 연결이 가능하기 때문이다. 그리고 사용하지 않는 코드는 즉시 삭제하는 것이 좋다. 바로 삭제하지 못하는 상황이이나 삭제하기 부담되는 상황이라면 주석 처리라도 해야 한다. 주석으로 처리하면 주석 처리한 이유와 날짜를 입력하는 것이 좋다. 예를 들어서 주석 처리한 곳에 ```2021-10-25 ~ 코드로 대체하여 삭제```라고 작성하여 대체 코드를 찾기 쉽도록 만드는 것이 좋다. 그렇다면 시간 낭비하는 문제는 줄일 수 있을 것이다.

[쓰지 않는 코드는 지울 것](https://www.youtube.com/watch?v=CJ0iEzQegX0)