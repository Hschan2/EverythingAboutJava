# Session VS Token VS Cookie 간단히 정리

## 쿠키
쿠키를 이용해서 서버는 브라우저에 데이터를 넣을 수 있다. 사용자는 브라우저를 통해 서버에 데이터를 요청한다. 그리고 서버에서 해당 데이터를 응답하는데 여기서 <b>쿠키</b>가 포함될 수 있다.   

그리고 사용자가 해당 브라우저에 접속할 때마다 쿠키가 전달될 수 있다. 쿠키는 서버에서 정해진 기간동안 저장되어 진다.   

쿠키는 인증뿐 만 아니라 여러 가지의 데이터를 저장할 수 있다. 예를 들면 언어 설정이 있다.

### Stateless
이는 서버로 가는 모든 요청이 이전 요청과 다르게 독립적으로 움직이는 것이다. 즉, 요청끼리 이어지지 않고 메모리가 없다는 것이다. 요청이 끝나면 모두 잊어버린다.   

그래서 요청하는 사용자가 누구인지 알리기 위해 사용하는 것이 <b>세션</b>이다.

## 세션
세션에는 별도의 아이디가 있는데 사용자가 해당 아이디에 요청할 경우, 해당 세션 아이디는 쿠키를 통해 브라우저로 돌아오고 저장된다. 그리고 브라우저는 해당 세션 아이디를 가지고 있는 쿠키를 서버에 보낸다.   

그러나 세션 아이디가 있는 쿠키를 요청하는 것 뿐이기 때문에 아직 사용자가 누구인지 모른다. 해당 세션 아이디를 가지고 세션 데이터 베이스를 확인할 것이고 거기서 해당 사용자를 알게 된다. 즉, 사용자의 요청이 있을 때마다 데이터 베이스에서 해당 사용자가 가지고 있는 세션 아이디 데이터를 찾는다.  

만약 사용자가 다른 페이지로 이동한다면 이러한 프로세스를 반복한다.   

여기에서 중요한 사용자의 정보는 모두 서버에 위치되어 있다.   

사용자가 가지고 있는 것은 세션 아이디고 쿠키는 세션 아이디를 전달하는 매개체일 뿐이다. 그러나 쿠키는 브라우저에 있기 때문에 네이티브 앱에는 존재하지 않는다. 네이티브 앱에는 토큰이 존재한다.   

그리고 사용자의 데이터가 늘수록 데이터 베이스 리소스 또한 늘어난다. 이 때, <b>JWT</b>가 나타난다. JWT는 토큰 형식으로 움직인다.

## 토큰
사용자에 해당되는 토큰을 서버에 보내고 서버에서 세션 데이터 ㅔ이스에서 해당 토큰과 일치하는 사용자를 찾는다.   

토큰을 사용하게 되면 세션 데이터 베이스를 가질 필요가 없고 사용자 인증을 위한 많은 과정을 거치지 않아도 된다. 토큰은 서버에서 받아서 요청할 때마다 응답한다.   

세션과 달리 토큰은 사용자가 서버에 요청을 하면 데이터 베이스에서 비교를 해서 사용자가 맞다면 해당 <b>사인된 정보</b>를 <b>String</b> 형태로 응답한다. (쿠키와 달리 토큰은 공간 제약이 없기 때문에 긴 형태로 응답)   

그리고 이 사인된 정보를 가지고 서버에 다시 요청을 한다. 서버는 해당 정보가 조작이 되었는지 확인을 하고 문제가 없다면 사용자를 인증한다.   

즉, <b>세션</b>은 세션 아이디를 가지고 세션 데이터 베이스에서 해당 아이디가 있을 경우, 사용자를 인증한다.   

<b>토큰 (JWT)</b>은 서버는 유저를 인증하는데 필요한 정보를 토큰에 저장하고 사용자에게 전달한다. 그리고 페이지를 요청하면 서버는 해당 토큰이 유효하다면 인증한다. (데이터 베이스 인증이 없다.)   

그러나 토큰 (JWT)은 암호화가 되어 있지 않다.   

## 세션과 토큰 (JWT)의 장점과 단점
* 세션
    * 장점
        * 서버는 로그인 된 사용자의 모든 정보를 저장하여 이를 이용하여 새로운 기능 추가 가능
        * 인스타그램의 로그인된 디바이스 관리, 넷플릭스의 사용자 유저 관리
    * 단점
        * 사용자의 수가 늘어난다면 데이터 베이스의 수도 늘어나야 한다.
        * 자주 사용하는 데이터 베이스는 Redis
* JWT (토큰)
    * 장점
        * 생성된 토큰을 추적하지 않는다. 토큰의 유효성만 본다.
        * 데이터 베이스를 구매할 필요가 없다.
        * 사용 예. 코로나 인증을 위한 QR 코드 체크인
    * 단점
        * 세션처럼 사용자의 로그인 관리 (강제 로그아웃) 등을 할 수 없다.   

서비스가 작고 사용자 관리를 많이 하지 않는다면 <b>JWT (토큰)</b>을 사용하는 것이 좋다. 그러나 서비스가 커지고 사용자의 관리가 필요하다면 <b>세션</b>을 사용하는 것이 좋다.   

## 마지막 정리
아주 간단하게 정리한다면 아래와 같다.   

* 쿠키: 정보를 옮기는 시스템 혹은 매개체
* 토큰: 서버가 기억하는 String 형태의 텍스트이며 서버에 이를 보여줘야 함
* JWT: 정보를 가지고 있는 토큰이며 데이터 베이스 없이 검증할 수 있음

[세션 vs 토큰 vs 쿠키 간단 정리](https://www.youtube.com/watch?v=tosLBcAX1vk)