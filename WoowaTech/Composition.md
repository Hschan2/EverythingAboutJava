# Composition

## 자바에서 상속의 특징
* 부모 클래스와 자식 클래스는 예약어 extends에 의해 정해진다.
* 하나의 부모 클래스는 여러 개의 자식 클래스를 가질 수 없다. 반대로 하나의 클래스는 여러 개의 클래스로부터 상속을 받을 수 없다.
* 부모 클래스로부터 상속받은 자식 클래스는 부모 클래스의 자원을 모두 사용할 수 있으나 부모 클래스는 자식 클래스의 자원을 가져다 쓸 수 없다.
* 자식 클래스는 또 다른 클래스의 부모 클래스가 될 수 있다.
* 자식 클래스는 부모 클래스로부터 물려받은 자원을 override하여 수정해 사용할 수 있다.
* 부모 클래스가 상속받은 자원도 자식 클래스가 사용이 가능하다.   

## 상속의 장점
1. 코드의 <b>재사용</b>을 통해 <b>중복</b>을 줄일 수 있다.   
2. <b>확장성</b>이 증가한다.   
3. 클래스 간의 계층적 관계를 구성함으로써 <b>다형성</b>을 구현할 수 있다.   
4. 개발 시간이 <b>단축</b>된다.   

## 상속의 문제점
* 캡슐화를 깨뜨린다.   
상위 클래스의 구현이 하위 클래스에 노출되기 때문에 ```캡슐화가 깨진다```. 따라서 자식 클래스가 ```부모 클래스에 강하게 결합 및 의존```하게 된다. 이로 인해 상위 클래스가 어떻게 구현되느냐에 따라 하위 클래스의 동작이 달라질 수 있다. ```상위 클래스의 내부 구현이 달라지면``` 코드한 줄 건드리지 않은 ```하위 클래스가 오동작할 수 있다```.   

또 다른 문제점은 부모 클래스의 결함이 자식 클래스에게도 넘어온다. 

## 상속 대신 조합(Composition)
조합은 기존 클래스를 확장하는 대신 새로운 클래스를 만들고 private 필드로 기존 클래스의 인스턴스를 참조하는 설계이다. 즉, 기존 클래스가 새로운 클래스의 구성 요소로 쓰이는 것이다.   

새 클래스의 인스턴스 메소드를 기존 클래스에 대응하는 메소드를 호출하여 그 결과를 반환하게 되는데 이 방식을 전달하며 이를, <b>Forwarding</b>이라고 한다. 그리고 새 클래스의 메소드들을 전달 메소드를 Forwarding Method라고 부른다.   

### 조합의 장점
1. 새로운 클래스는 ```기존 크래스의 내부 구현 방식의 영향에서 벗어나며```, 심지어 기존 클래스에 새로운 메소드가 추가되어도 전혀 영향을 받지 않는다.   
2. 메소드를 호출하는 방식으로 동작하기 때문에 ```캡슐화를 깨뜨리지 않는다```.   
3. 상위 클래스에 의존하지 않기 때문에 ```변화에 유연하다```.   

즉, 조합은 캡슐화를 깨뜨리고 부모 클래스에 의존하는 상속의 단점들을 해결할 수 있다. 그리고 유연성까지 갖추고 있다. 또한 단순히 메소드 호출을 통해 값을 사용하면 되기 때문에 구현이 쉽다.   

### 조합 예시
일반적으로 상속은 ls - a 관계에 있다고 표현한다. (예. Coffee is CaffeinBeverage)   

조합도 이와 비슷하게 Has - a 관계에 있다. (예. WinningLotto has a Lotto)   

```
public class WinningLotto {
    private final Lotto lotto;
    private final LottoNumber bonusBall;

    public WinningLotto(Lotto lotto, LottoNumber bonusBall) {
        validateWinningLotto(lotto, bonusBall);
        this.lotto = lotto;
        this.bonusBall = bonusBall;
    }
}
```

```
private final Lotto lotto;
private final LottoNumber bonusBall;
```
조합을 사용하면 기존 클래스인 Lotto, LottoNumber 클래스의 변화에 영향이 적어진다. 즉, 변화에 유연하다.   

## 상속은 사용하지 말자?
아니다. 제대로 사용하자는 의미이다. 상속을 사용할 때는   

* 명확한 ls - a 관계에 있는 경우
* 상위 클래스가 확장할 목적으로 설계되었고 문서화도 잘 되어 있는 경우   

