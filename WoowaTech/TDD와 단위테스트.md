# TDD와 단위 테스트

## TDD
테스트 코드를 먼저 만들고, 실제 프로덕션 코드를 나중에 만드는 개발 방법.

```
프로그램을 작성하기 전에 테스트를 먼저 하라!
- 캔트 백, Kent beck -
```

```
설계 -> 개발(코드작성) -> 테스트(코드작성) -> 설계 = X
설계 -> 테스트(코드작성) -> 반복 -> 개발(코드작성) = O
```

### TDD Cycle
1. 실패하는 테스트를 구현   
2. 테스트가 성공하도록 프로덕션 코드를 구현   
3. 프로덕션 코드와 테스트 코드를 리팩토링   

### TDD 사용 이유
#### 테스트 코드의 장점
* 변화에 대한 두려움을 줄여준다. (리팩토링 편리)
* 디버깅 시간을 줄여준다.
* 동작하는 문서 역할을 한다.   

#### TDD의 장점
* TDD를 하면 자연스럽게 테스트 커버리지가 높아진다.
* 오버 엔지니어링을 방지한다. (필요한 만큼만 개발이 가능. 즉, 불필요한 코드 감소)
* 설계에 대한 피드백이 빠르다.

### TDD는 설계방법론?
* TDD는 높은 응집을 유도하지 않는다.
* TDD는 단일 책임 원칙과 인터페이스 분리 원칙 위배에 어떤 신호도 주지 않는다.
* TDD는 인터페이스 일관성을 도출하지 않는다.
* TDD의 리팩토링 단계는 좋은 구조를 안내하거나 좋은 구조를 갖도록 강제하지 않는다.   

그러나 TDD는 <B>강한 결합</B>과 <B>의존성 역전 원칙 위배</B>를 경고하고 불명확한 설계 지점을 발견해주기도 한다.   

그리고 TDD에 너무 의존한다면, 테스트에만 좋은 코드를 작성하게 된다.   

### TDD를 실패하는 이유
* 코드가 이루어지고자 하는 가치나 기능을 테스트하기보다 그 기능을 어떻게 구현하고 있는지 테스트한다.
* 테스트 케이스들이 구현체와 결합도가 높아진다.
* 구현체들을 리팩토링하면 결합되어 있는 테스트 케이스들이 모두 깨진다.   

즉, 테스트를 Implementation에 테스트하기 보다 Interface에 테스트해야 한다.   

## 테스트의 범위
```
Acceptance(인수) Testing
    Stress/Load(부하) Testing
        Function(기능) Testing
            Integration(통합) Testing
                Unit(단위) Testing
```

* 통합 테스트: 여러 작업 단위가 연계된 워크 플로우를 테스트하기 위한 수단 (객체 간, 서비스 간, 시스템 간)
* 기능 테스트: 공개된 API의 가장 바깥쪽에 해당하는 코드 검사 (Controller 호출, Security, HTTP)
* 부하 테스트: 주어진 단위 시간동안 애플리케이션이 얼마나 많은 요청을 처리할 수 있는지 검사
* 인수 테스트: 고객 또는 대리인이 정의되어진 모든 목적에 부합되는지 확인해보고자 하는 검사   

## 단위 테스트
* 가장 작은 단위의 테스트
* 일반적으로 메소드 레벨
* 검증이 필요한 코드에 대해 테스트 케이스를 작성하는 <b>절차</b> 또는 <b>프로세스</b>
* Unit Testing은 테스트 코드가 목적 코드의 완전성을 입증 해주기 때문에, 테스트 코드 자체만으로 주요한 가치   

### 단위 테스트 목적
1. 문제점 발견 (프로그램 안정성 증가)   
2. 쉬운 변경   
3. 품질 향상 (하나의 메소드는 하나의 역할)   
4. 코드의 문서화 (샘플 코드, 예외 상황과 용도 그리고 의존 관계 파악 가능)   
5. 최신 상태 유지 (배포되는 코드와 일치하기 때문에)   

### 좋은 단위 테스트
<b>F.I.R.S.T 법칙</b>   

* F: Fast (빠르게)
* I: Independent (독립적으로)
* R: Repeatable (반복 가능하게)
* S: Self-Validating (자가 검증하는)
* T: Timely (적시에)   

테스트는 빨라야 한다. 문제를 <b>빨리</b> 찾고 해결해야 코드 품질을 높일 수 있다. 그리고 서로 <b>의존</b>하면 안 된다. 한 번 실패하면 계속 실패하게 된다. 어떤 환경에서도 <b>반복</b> 가능해야 한다. 실제 환경과 QA 환경, 네트워크가 연결되어 있지 않은 상태에서 실행되어야 한다. 그리고 테스트는 <b>Boolean 값</b>으로 결과를 내야 한다. 즉, <b>성공</b>과 <b>실패</b>를 무조건 반환해야 한다. 마지막으로 테스트는 실제 코드를 구현하기 <b>직전에</b> 구현해야 한다. 즉, 실제 코드보다 테스트 코드가 먼저 작성되야 한다.   

[TDD와 단위 테스트 출처](https://www.youtube.com/watch?v=3LMmPXoGI9Q)